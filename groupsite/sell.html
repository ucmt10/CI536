<?php

    //initalise html
    $html = '<p>Enter details for people table</p>';

    // check post parameters
    if(isset($_POST['firstName']) && isset($_POST['lastName']) && isset($_POST['phone'])) {

        //data validation
        $firstname = $_POST['firstName'];
        $lastname = $_POST['lastName'];
        $phone = $_POST['phone'];

        //check length
        if (strlen($firstname) <= 64 && strlen($lastname) <= 64 && strlen($phone) <= 32) {
            //you could do other checks here

            //save to database (server host, username, password, database name)
                $mysqli = mysqli_connect("localhost", "rk506_bazaaruser", "Bazaaruser", "rk506_bazaar");
            
            //protection against SQL injection
            $firstname = mysqli_real_escape_string($mysqli, $firstname);
            $lastname = mysqli_real_escape_string($mysqli, $lastname);
            $phone = mysqli_real_escape_string($mysqli, $phone);

            //build the SQL statement
            $sql = "INSERT INTO users (firstName, lastName, phone) " . "VALUES ('$firstname', '$lastname', '$phone')";

            //execute SQL statement
            $result = mysqli_query($mysqli, $sql);
            if ($result !== false) {
                //gives you back last generated id - Marcus: "that's quirky"
                $id = mysqli_insert_id($mysqli);
                $html = "<p>Success! Insert id = $id. Enter more people if you want.</p>";
            }
            $id = mysqli_insert_id($mysqli);

            //get insert id and show it
        }
        else {
            $html = '<p>One or more of the values are too long, try again.</p>';
        }
        

        
        //$html = '<p>Welcome back, ' . $user . '</p>' . '<p><a href="./post.php">Log Out</a></p>';
    }

    $html .= '<form method="POST" action="" >'
        . '<label for="Bookname">Bookname: </label>'
        . '<input type="text" id="Bookname "name="Bookname" />'
        . '<br><label for="BookAuthor">Book Author: </label>'
        . '<input type="text" id="BookAuthor" name="BookAuthor" />'
        . '<br><label for="text">Year: </label>'
        . '<input type="tel" id="Year" name="Year" />'
        . '<input type="submit" value="Save to Database" id="savebutton" />'
        . '</form>';

?>


<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
   <link href="sell.css" rel="stylesheet" /> 
    <script src="sell.js"></script>  
    <title>Brighton Bazaar</title>
</head>






<body>


    <main>
        <header>

            <div class="topbar">

                <div class="navigation">

                    <a href="../home.html">Home</a>
                    <a href="../buy.html">Buy</a>
                    <a class="active" href="sell.html">Sell</a>
                    <a href="../login.php" id="login">Log In</a>
                    <form id="form">
                        <input type="search" class="search" id="query" placeholder="Seach images....">
                        <button>
                            <svg viewBox="0 0 1024 1024">
                                <path class="path1"
                                    d="M848.471 928l-263.059-263.059c-48.941 36.706-110.118 55.059-177.412 55.059-171.294 0-312-140.706-312-312s140.706-312 312-312c171.294 0 312 140.706 312 312 0 67.294-24.471 128.471-55.059 177.412l263.059 263.059-79.529 79.529zM189.623 408.078c0 121.364 97.091 218.455 218.455 218.455s218.455-97.091 218.455-218.455c0-121.364-103.159-218.455-218.455-218.455-121.364 0-218.455 97.091-218.455 218.455z">
                                </path>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>

        </header>

        

        <div id="section1">
            <div id="ani_GIF">
                    <img id="GIF_1" src="../images/GIF_1.gif"
                    alt="an image for sell an item">   
            </div>
        </div>
        <div id="textcontainer_1">
            <h1> Weclome! </h1>
            <h2> Let's post an ad</h2>
            
             <?php
            echo $html;
        ?>
            
        </div>

    



    </main>
    <footer>

    </footer>

</body>


</html>